<html><head>
	<title>Leaflet Essentials</title>
	<link href="https://netdna.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.css" rel="stylesheet">

	<link href="css/leaflet.awesome-markers.css" rel="stylesheet">
	<link href="css/leaflet.css" rel="stylesheet">
	<link href="css/leaflet.extra-markers.min.css" rel="stylesheet">
	<script src="js/turf.min.js" type="text/javascript"></script>
	<script src="js/leaflet-geodesy.js" type="text/javascript"></script>
	
	<script>
		ACCESS_TOKEN = 'pk.eyJ1IjoibWFwYm94IiwiYSI6ImNpandmbXliNDBjZWd2M2x6bDk3c2ZtOTkifQ._QA7i5Mpkd_m30IGElHziw';
		MB_ATTR = 'Map data &copy; <a href="http://openstreetmap.org">OpenStreetMap</a> contributors, ' +
			'<a href="http://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, ' +
			'Imagery c <a href="http://mapbox.com">Mapbox</a>';
		MB_URL = 'https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.png?access_token=' + ACCESS_TOKEN;
		OSM_URL = 'http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png';
		OSM_ATTRIB = '&copy; <a href="http://openstreetmap.org/copyright">OpenStreetMap</a> contributors';
	</script>
<style>
	.info {
		padding: 6px 8px;
		font: 14px/16px Arial, Helvetica, sans-serif;
		background: white;
		background: rgba(255,255,255,0.8);
		box-shadow: 0 0 15px rgba(0,0,0,0.2);
		border-radius: 5px;
	}
	.info h4 {
		margin: 0 0 5px;
		color: #777;
	}

	.legend {
		text-align: left;
		line-height: 18px;
		color: #555;
	}
	.legend i {
		width: 18px;
		height: 18px;
		float: left;
		margin-right: 8px;
		opacity: 0.7;
	}
</style>
<script>function focus() { mymap.panTo(new L.LatLng(25.075891, 121.608948));}</script><script>function legendcreate() { legend.onAdd = function (mymap) { var div = L.DomUtil.create('div', 'info legend'), grades = ['LARs', 'RODs', '預警範圍'], labels = ['./legend/LARs.png', './legend/RODs.png', './legend/Buffer.png']; for (var i = 0; i < grades.length; i++) {div.innerHTML += grades[i] + (' <img src='+ labels[i] +'>') +'<br>';} return div;}; legend.addTo(mymap); }</script></head>

<body>
<div tabindex="0" class="mapclass leaflet-container leaflet-touch leaflet-fade-anim leaflet-grab" id="mapid" style="height: 720px; position: relative;"><div class="leaflet-pane leaflet-map-pane leaflet-pan-anim" style="transform: translate(0px, 0px);"><div class="leaflet-pane leaflet-tile-pane"><div class="leaflet-layer" style="z-index: 1;"><div class="leaflet-tile-container leaflet-zoom-animated" style="z-index: 18; transform: translate(0px, 0px) scale(1);"><img class="leaflet-tile" style="width: 256px; height: 256px; transform: translate(128px, 141px);" alt="" src="https://api.tiles.mapbox.com/v4/mapbox.streets/8/214/109.png?access_token=pk.eyJ1IjoibWFwYm94IiwiYSI6ImNpandmbXliNDBjZWd2M2x6bDk3c2ZtOTkifQ._QA7i5Mpkd_m30IGElHziw"><img class="leaflet-tile" style="width: 256px; height: 256px; transform: translate(128px, -115px);" alt="" src="https://api.tiles.mapbox.com/v4/mapbox.streets/8/214/108.png?access_token=pk.eyJ1IjoibWFwYm94IiwiYSI6ImNpandmbXliNDBjZWd2M2x6bDk3c2ZtOTkifQ._QA7i5Mpkd_m30IGElHziw"><img class="leaflet-tile" style="width: 256px; height: 256px; transform: translate(-128px, 141px);" alt="" src="https://api.tiles.mapbox.com/v4/mapbox.streets/8/213/109.png?access_token=pk.eyJ1IjoibWFwYm94IiwiYSI6ImNpandmbXliNDBjZWd2M2x6bDk3c2ZtOTkifQ._QA7i5Mpkd_m30IGElHziw"><img class="leaflet-tile" style="width: 256px; height: 256px; transform: translate(384px, 141px);" alt="" src="https://api.tiles.mapbox.com/v4/mapbox.streets/8/215/109.png?access_token=pk.eyJ1IjoibWFwYm94IiwiYSI6ImNpandmbXliNDBjZWd2M2x6bDk3c2ZtOTkifQ._QA7i5Mpkd_m30IGElHziw"><img class="leaflet-tile" style="width: 256px; height: 256px; transform: translate(128px, 397px);" alt="" src="https://api.tiles.mapbox.com/v4/mapbox.streets/8/214/110.png?access_token=pk.eyJ1IjoibWFwYm94IiwiYSI6ImNpandmbXliNDBjZWd2M2x6bDk3c2ZtOTkifQ._QA7i5Mpkd_m30IGElHziw"><img class="leaflet-tile" style="width: 256px; height: 256px; transform: translate(-128px, -115px);" alt="" src="https://api.tiles.mapbox.com/v4/mapbox.streets/8/213/108.png?access_token=pk.eyJ1IjoibWFwYm94IiwiYSI6ImNpandmbXliNDBjZWd2M2x6bDk3c2ZtOTkifQ._QA7i5Mpkd_m30IGElHziw"><img class="leaflet-tile" style="width: 256px; height: 256px; transform: translate(384px, -115px);" alt="" src="https://api.tiles.mapbox.com/v4/mapbox.streets/8/215/108.png?access_token=pk.eyJ1IjoibWFwYm94IiwiYSI6ImNpandmbXliNDBjZWd2M2x6bDk3c2ZtOTkifQ._QA7i5Mpkd_m30IGElHziw"><img class="leaflet-tile" style="width: 256px; height: 256px; transform: translate(-128px, 397px);" alt="" src="https://api.tiles.mapbox.com/v4/mapbox.streets/8/213/110.png?access_token=pk.eyJ1IjoibWFwYm94IiwiYSI6ImNpandmbXliNDBjZWd2M2x6bDk3c2ZtOTkifQ._QA7i5Mpkd_m30IGElHziw"><img class="leaflet-tile" style="width: 256px; height: 256px; transform: translate(384px, 397px);" alt="" src="https://api.tiles.mapbox.com/v4/mapbox.streets/8/215/110.png?access_token=pk.eyJ1IjoibWFwYm94IiwiYSI6ImNpandmbXliNDBjZWd2M2x6bDk3c2ZtOTkifQ._QA7i5Mpkd_m30IGElHziw"></div></div></div><div class="leaflet-pane leaflet-shadow-pane"><div class="awesome-marker-shadow awesome-marker leaflet-zoom-animated" style="width: 36px; height: 16px; margin-top: -12px; margin-left: -10px; transform: translate(250px, 287px);"></div><div class="awesome-marker-shadow awesome-marker leaflet-zoom-animated" style="width: 36px; height: 16px; margin-top: -12px; margin-left: -10px; transform: translate(255px, 259px);"></div><div class="awesome-marker-shadow awesome-marker leaflet-zoom-animated" style="width: 36px; height: 16px; margin-top: -12px; margin-left: -10px; transform: translate(271px, 278px);"></div><div class="awesome-marker-shadow awesome-marker leaflet-zoom-animated" style="width: 36px; height: 16px; margin-top: -12px; margin-left: -10px; transform: translate(276px, 276px);"></div></div><div class="leaflet-pane leaflet-overlay-pane"><svg xmlns="http://www.w3.org/2000/svg" class="leaflet-zoom-animated" style="transform: translate(-47px, -60px);" pointer-events="none" viewBox="-47 -60 569 720" width="569" height="720"><g><path class="leaflet-interactive" fill="#3388ff" fill-opacity="0.5" fill-rule="evenodd" stroke="#3388ff" stroke-linecap="round" stroke-linejoin="round" stroke-opacity="0" stroke-width="3" d="M 250 275 L 255 276 L 259 279 L 259 275 L 266 267 L 278 264 L 281 265 L 286 270 L 287 279 L 285 284 L 281 287 L 272 290 L 266 289 L 262 285 L 261 292 L 258 296 L 252 299 L 248 299 L 245 298 L 240 293 L 239 283 L 245 276 L 250 275 Z M 255 247 L 261 249 L 266 255 L 266 263 L 259 270 L 248 269 L 243 262 L 244 253 L 249 248 L 254 247 Z" /></g></svg></div><div class="leaflet-pane leaflet-marker-pane"><div tabindex="0" class="awesome-marker-icon-green awesome-marker leaflet-zoom-animated leaflet-interactive" style="width: 35px; height: 45px; margin-top: -42px; margin-left: -17px; z-index: 287; transform: translate(250px, 287px);"><i class=" fa fa-medkit  icon-white"></i></div><div tabindex="0" class="awesome-marker-icon-green awesome-marker leaflet-zoom-animated leaflet-interactive" style="width: 35px; height: 45px; margin-top: -42px; margin-left: -17px; z-index: 259; transform: translate(255px, 259px);"><i class=" fa fa-medkit  icon-white"></i></div><div tabindex="0" class="awesome-marker-icon-blue awesome-marker leaflet-zoom-animated leaflet-interactive" style="width: 35px; height: 45px; margin-top: -42px; margin-left: -17px; z-index: 278; transform: translate(271px, 278px);"><i class=" fa fa-medkit  icon-white"></i></div><div tabindex="0" class="awesome-marker-icon-green awesome-marker leaflet-zoom-animated leaflet-interactive" style="width: 35px; height: 45px; margin-top: -42px; margin-left: -17px; z-index: 276; transform: translate(276px, 276px);"><i class=" fa fa-medkit  icon-white"></i></div></div><div class="leaflet-pane leaflet-popup-pane"></div><div class="leaflet-proxy leaflet-zoom-animated" style="transform: translate(54892.8px, 28063px) scale(128);"></div></div><div class="leaflet-control-container"><div class="leaflet-top leaflet-left"><div class="leaflet-control-zoom leaflet-bar leaflet-control"><a title="Zoom in" class="leaflet-control-zoom-in" href="#">+</a><a title="Zoom out" class="leaflet-control-zoom-out" href="#">-</a></div></div><div class="leaflet-top leaflet-right"><div class="info legend leaflet-control">LARs <img src="./legend/LARs.png"><br>RODs <img src="./legend/RODs.png"><br>預警範圍 <img src="./legend/Buffer.png"><br></div></div><div class="leaflet-bottom leaflet-left"></div><div class="leaflet-bottom leaflet-right"><div class="leaflet-control-attribution leaflet-control"><a title="A JS library for interactive maps" href="http://leafletjs.com">Leaflet</a> | Map data c <a href="http://openstreetmap.org">OpenStreetMap</a> contributors, <a href="http://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, Imagery c <a href="http://mapbox.com">Mapbox</a></div></div></div></div>
<div id="points"></div>
<script src="js/leaflet.js"></script>
<script src="js/leaflet.awesome-markers.js"></script>
<script src="js/leaflet.extra-markers.min.js"></script>
<script>
var mymap = L.map('mapid').setView([25.011, 121.535], 8)
L.tileLayer(MB_URL, {attribution: MB_ATTR, id: 'mapbox.streets'}).addTo(mymap);
var hospitals = L.layerGroup();
var hbuffers = L.layerGroup();
var legend = L.control({position: 'topright'});
//mymap.on('zoomend', function() {
//var currentZoom = mymap.getZoom();
//hospitals.eachLayer(function (layer) {
//        //console.log(layer._leaflet_id);
//    var my_icon2 = layer.options.icon;
//   var xsize = 46 * (currentZoom / 13)^1.5;
//    var ysize = 33 * (currentZoom / 13)^1.5;
//    my_icon2.options.iconSize = [xsize, ysize];
//   layer.setIcon(my_icon2);
//});
//});

function clear(){
	hbuffers.clearLayers();
	mymap.eachLayer(function (layer){
        mymap.removeLayer(layer);
        L.tileLayer(MB_URL, {attribution: MB_ATTR, id: 'mapbox.streets'}).addTo(mymap);
});
	
}

//var test = L.geoJson();
function unify(){
	for(var i = 0; i < hbuffers.getLayers().length; i++)
	{
		if( i == 0 ){var unionTemp = hbuffers.getLayers()[i].toGeoJSON();} else{ unionTemp = turf.union(unionTemp, hbuffers.getLayers()[i].toGeoJSON());}
	}
	//test.addData(unionTemp, {style: {opacity: 0, fillOpacity: 0.5}}).addTo(mymap);
	L.geoJson(unionTemp, {style: {opacity: 0, fillOpacity: 0.5}}).addTo(mymap);
}
//var cityUnion = unify(hbuffers.getLayers()).addTo(mymap);
//var buffer6 = new LGeo.circle([25.026761, 121.563428],6500, {parts: 144}); hospitals.addLayer(buffer6); mymap.addLayer(buffer6);
//mymarker = new L.marker([25.011, 121.535], {icon: L.AwesomeMarkers.icon({icon: 'medkit', prefix: 'fa', markerColor: 'blue'})}); mymap.addLayer(mymarker); mymarker.bindPopup('" + hospitalList[i].name + "');
//var marker = L.marker([25.011, 121.535]).addTo(mymap);
//mymarker.on('click', function onClick() { document.getElementById('points').innerHTML = String(mymarker._popup.getContent())});


//mymap.on('click',function(e){L.marker(e.latlng).addTo(mymap).bindPopup("SEARCH LOCATION").openPopup();
//var a=String(e.latlng).split(",");
//var lat=a[0].split("(");
//var lon=a[1].split(")");
//document.getElementById("points").innerHTML = "123123";
//});


</script>

<script></script><script>
var buffer0; buffer0 = new LGeo.circle([25.075891, 121.608948],6500, {parts: 144}); hbuffers.addLayer(buffer0);
var buffer1; buffer1 = new LGeo.circle([25.216382, 121.633073],6500, {parts: 144}); hbuffers.addLayer(buffer1);
var buffer2; buffer2 = new LGeo.circle([25.120702, 121.72236],6500, {parts: 144}); hbuffers.addLayer(buffer2);
var buffer3; buffer3 = new LGeo.circle([25.130262, 121.748129],6500, {parts: 144}); hbuffers.addLayer(buffer3);
unify();</script><script>
var mymarker0; mymarker0 = new L.marker([25.075891, 121.608948], {icon: L.AwesomeMarkers.icon({icon: 'medkit', prefix: 'fa', markerColor: 'green'})}); hospitals.addLayer(mymarker0);mymap.addLayer(mymarker0); mymarker0.bindPopup('康寧醫療財團法人康寧醫院');
var mymarker1; mymarker1 = new L.marker([25.216382, 121.633073], {icon: L.AwesomeMarkers.icon({icon: 'medkit', prefix: 'fa', markerColor: 'green'})}); hospitals.addLayer(mymarker1);mymap.addLayer(mymarker1); mymarker1.bindPopup('國立臺灣大學醫學院附設醫院金山分院');
var mymarker2; mymarker2 = new L.marker([25.120702, 121.72236], {icon: L.AwesomeMarkers.icon({icon: 'medkit', prefix: 'fa', markerColor: 'blue'})}); hospitals.addLayer(mymarker2); mymap.addLayer(mymarker2); mymarker2.bindPopup('長庚醫療財團法人基隆長庚紀念醫院');
var mymarker3; mymarker3 = new L.marker([25.130262, 121.748129], {icon: L.AwesomeMarkers.icon({icon: 'medkit', prefix: 'fa', markerColor: 'green'})}); hospitals.addLayer(mymarker3);mymap.addLayer(mymarker3); mymarker3.bindPopup('衛生福利部基隆醫院');</script></body></html>